<!doctype html>
<!-- The Time Machine GitHub pages theme was designed and developed by Jon Rohan, on Feb 7, 2012. -->
<!-- Follow him for fun. http://twitter.com/jonrohan. Tail his code on http://github.com/jonrohan -->
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <link rel="stylesheet" href="stylesheets/stylesheet.css" media="screen">
  <link rel="stylesheet" href="stylesheets/pygment_trac.css">
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="javascripts/script.js"></script>

  <title>Doc</title>
  <meta name="description" content="MyDoc">

  <meta name="viewport" content="width=device-width,initial-scale=1">

</head>

<body>

  <div class="wrapper">
    <header>
      <h1 class="title">Doc</h1>
    </header>
    <div id="container">
      <p class="tagline">MyDoc</p>
      <div id="main" role="main">
        <div class="download-bar">
        <div class="inner">
          <a href="https://github.com/DanielCxh/Doc/tarball/master" class="download-button tar"><span>Download</span></a>
          <a href="https://github.com/DanielCxh/Doc/zipball/master" class="download-button zip"><span>Download</span></a>
          <a href="https://github.com/DanielCxh/Doc" class="code">View Doc on GitHub</a>
        </div>
        <span class="blc"></span><span class="trc"></span>
        </div>
        <article class="markdown-body">
          <h3>
<a name="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages"><span class="octicon octicon-link"></span></a>Welcome to GitHub Pages.</h3>

<p>This automatic page generator is the easiest way to create beautiful pages for all of your projects. Author your page content here using GitHub Flavored Markdown, select a template crafted by a designer, and publish. After your page is generated, you can check out the new branch:</p>

<pre><code>$ cd your_repo_root/repo_name
$ git fetch origin
$ git checkout gh-pages
</code></pre>

<p>If you're using the GitHub for Mac, simply sync your repository and you'll see the new branch.</p>

<h3>
<a name="designer-templates" class="anchor" href="#designer-templates"><span class="octicon octicon-link"></span></a>Designer Templates</h3>

<p>We've crafted some handsome templates for you to use. Go ahead and continue to layouts to browse through them. You can easily go back to edit your page before publishing. After publishing your page, you can revisit the page generator and switch to another theme. Your Page content will be preserved if it remained markdown format.</p>

<h3>
<a name="rather-drive-stick" class="anchor" href="#rather-drive-stick"><span class="octicon octicon-link"></span></a>Rather Drive Stick?</h3>

<p>If you prefer to not use the automatic generator, push a branch named <code>gh-pages</code> to your repository to create a page manually. In addition to supporting regular HTML content, GitHub Pages support Jekyll, a simple, blog aware static site generator written by our own Tom Preston-Werner. Jekyll makes it easy to create site-wide headers and footers without having to copy them across every page. It also offers intelligent blog support and other advanced templating features.</p>

<h3>
<a name="authors-and-contributors" class="anchor" href="#authors-and-contributors"><span class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>You can <a href="https://github.com/blog/821" class="user-mention">@mention</a> a GitHub username to generate a link to their profile. The resulting <code>&lt;a&gt;</code> element will link to the contributor's GitHub Profile. For example: In 2007, Chris Wanstrath (<a href="https://github.com/defunkt" class="user-mention">@defunkt</a>), PJ Hyett (<a href="https://github.com/pjhyett" class="user-mention">@pjhyett</a>), and Tom Preston-Werner (<a href="https://github.com/mojombo" class="user-mention">@mojombo</a>) founded GitHub.</p>

<h3>
<a name="support-or-contact" class="anchor" href="#support-or-contact"><span class="octicon octicon-link"></span></a>Support or Contact</h3>
<a href="https://github.com/DanielCxh/Doc/info.html">Visit W3CSchool</a>
<p>Having trouble with Pages? Check out the documentation at <a href="http://help.github.com/pages">http://help.github.com/pages</a> or contact <a href="mailto:support@github.com">support@github.com</a> and we’ll help you sort it out.</p>
        </article>
      </div>
    </div>
    <footer>
      <div class="owner">
      <p><a href="https://github.com/DanielCxh" class="avatar"><img src="https://avatars3.githubusercontent.com/u/6868715?v=2&amp;s=60" width="48" height="48"></a> <a href="https://github.com/DanielCxh">DanielCxh</a> maintains <a href="https://github.com/DanielCxh/Doc">Doc</a></p>


      </div>
      <div class="creds">
        <small>This page generated using <a href="http://pages.github.com/">GitHub Pages</a><br>theme by <a href="https://twitter.com/jonrohan/">Jon Rohan</a></small>
      </div>
    </footer>
  </div>
  <div class="current-section">
    <a href="#top">Scroll to top</a>
    <a href="https://github.com/DanielCxh/Doc/tarball/master" class="tar">tar</a><a href="https://github.com/DanielCxh/Doc/zipball/master" class="zip">zip</a><a href="" class="code">source code</a>
    <p class="name"></p>
  </div>


<style>

td{
  -webkit-border-radius: 15px;
}

#infoBar{
  background-color: grey;
  font-size: 30px;
  position: absolute;
  top:100px;
  width:200px; 
}

.dog {
  background-color: blue;
  position: absolute;
  width : 20px;
  height: 20px;
  visibility: hidden;
}

</style>


<input type="text" id="line">行数
<input type="text" id="list">列数
<input type="button" value="添加表格" onclick="autocreate()">
<div id="d1"></div>

<div id="infoBar" onclick="gameStart()">
  <p> GAME START</p>
</div>

<div class="dog"></div>


<script>

var GAME_STATUS = {'START':0,'STOP':1,'PAUSE':2};
var matrix = null;

var totalLine = 0;
var totalList = 0;

var level = 1;
var steps = 0;
var gameStatus = GAME_STATUS.START;

var cellSize = 30;

var DOG_LOCATION = {'LINE':0, 'LIST':0};

// Dog move direction.
var DIRECTION = {'LEFT':0,
                 'RIGHT':1,
                 'UP':2,
                 'DOWN':3,
                 'LEFT_UP':4,
                 'LEFT_DOWN':5,
                 'RIGHT_UP':6,
                 'RIGHT_DOWN':7};

// The direction that dog can move.
var canMove = [];

function autocreate(){
    // Create Table
    var table = document.createElement("table");
    table.setAttribute("border","1");
    table.setAttribute("id", "mainTable");
    //table.setAttribute("background-color","red");
    
    //获取行数值
    var line=document.getElementById("line").value;
    //获取列数值
    var list=document.getElementById("list").value;
  
    totalLine = new Number(line);
    totalList = new Number(list);
   
    createGameMatrix();
  
    var tableWidth =  cellSize * list;
    var tableHeight = cellSize * line;
  
  
   // matrix = [line][list];
    table.setAttribute("width", tableWidth + "px");
    table.setAttribute("height", tableHeight + "px");
    table.setAttribute("align", "center");
  
  for(var i=0;i<line;i++){
        //alert(line);
        //创建tr
        var tr=document.createElement("tr");
        for(var j=0;j<list;j++){
            //alert(list);
            //创建td
            var td=document.createElement("td");
            td.setAttribute("bgColor", "white");
            // Add click event.
            td.setAttribute("onClick", "onCellClick(" + i+"," +j+")");
            tr.appendChild(td);
            }
            table.appendChild(tr);
           
        }
        //table.rows[i].cells[j].onClick=onC;
  
        document.getElementById("d1").appendChild(table);
    }

// This funciton do the action while click cell.
function onCellClick(line, list) {
  
  //setCellChecked(line, list);
   matrix[line][list] = 1;
  //console.error(matrix[line,list]);
  dogMove();
  redraw();
 
}

// Set the block locked.
function setCellChecked(line, list){
  var table = document.getElementById("mainTable");
  table.rows[line].cells[list].setAttribute("bgColor", "red");
}

// Redraw the screen.
function redraw(){

  for(var i = 0; i < totalLine; i++) {
    for(var j = 0; j < totalList; j++) {
      if(true === isCellFull(i, j)){
           setCellChecked(i, j);
         }
    }
  }
}

// Start the game.
function gameStart(){

  
  // Initialize
  var table = document.getElementById("mainTable");
  if (null != table) {
    document.getElementById("d1").removeChild(table);
    console.error("move");
  }
  autocreate();
  dogLocation();
  createDefaultBlock();
  redraw();
}

// Auto create default block.
function createDefaultBlock(){
  var times = 0;
  times = (totalLine * totalList) / (level * totalLine);
  
  for(var i = 0; i < times; i++) {
    var random = parseInt(Math.random() * totalLine * totalList);
  
    var nLine = parseInt(random / totalLine);
    var nList = parseInt(random % totalList);
    console.error(random + ":" + nLine + ":" + nList);
    if (true === isCellFull(nLine, nList)){
      i--;
    } else {
      matrix[nLine][nList] = 1;
    }
  }
}

// Check block.
function isCellFull(row, col){
  if (0 != matrix[row][col]) {
    return true;
  } else {
    return false;
  }
}

// Game end.
function gameEnd(){
      alert("You lost");
}

// Dog location.
function dogLocation() {
  
  
  DOG_LOCATION.LIST = parseInt(totalList / 2);
  DOG_LOCATION.LINE = parseInt(totalLine / 2);
  
  setDogLocation(DOG_LOCATION.LINE, DOG_LOCATION.LIST);
  console.error("line" + DOG_LOCATION.LINE +": list"+ DOG_LOCATION.LIST);
}

function setDogLocation(x, y){
  var table = document.getElementById("mainTable");
  var tableWidth = table.offsetWidth;
  var tableHeight = table.offsetHeight;
  var tableLeft = table.offsetLeft;
  var tableTop = table.offsetTop;
  
  var dog = document.getElementsByClassName("dog");
  
  //var dogLeft = tableLeft + (tableWidth / 2);
  //var dogTop = tableTop + (tableHeight / 2);
  
  var dogLeft = tableLeft + cellSize * y;
  var dogTop = tableTop + cellSize * x;
  
  // Set dog location.
  dog[0].style.top = dogTop + "px";
  dog[0].style.left = dogLeft + "px";
  
  // Show dog.
  dog[0].style.visibility= "visible";
}

// Dog move.
function dogMove() {
  if(0 === DOG_LOCATION.LINE
     || 0 === DOG_LOCATION.LIST
     || (totalList - 1) === DOG_LOCATION.LIST
     || (totalLine - 1) === DOG_LOCATION.LINE) {
    // Game over
    gameEnd();
    return;
  }
  
  if (0 === matrix[DOG_LOCATION.LINE][DOG_LOCATION.LIST - 1]) {
    canMove.push(DIRECTION.LEFT);
  }
  if (0 === matrix[DOG_LOCATION.LINE][DOG_LOCATION.LIST + 1]){
    canMove.push(DIRECTION.RIGHT);
  }
  if (0 === matrix[DOG_LOCATION.LINE - 1][DOG_LOCATION.LIST]) {
    canMove.push(DIRECTION.UP);
  }
  if (0 === matrix[DOG_LOCATION.LINE + 1][DOG_LOCATION.LIST]) {
    canMove.push(DIRECTION.DOWN);
  }
  if (0 === matrix[DOG_LOCATION.LINE - 1][DOG_LOCATION.LIST - 1]){
    canMove.push(DIRECTION.LEFT_UP);
  }
  if (0 === matrix[DOG_LOCATION.LINE + 1][DOG_LOCATION.LIST - 1]) {
    canMove.push(DIRECTION.LEFT_DOWN);
  }
  if (0 === matrix[DOG_LOCATION.LINE - 1][DOG_LOCATION.LIST + 1]) {
    canMove.push(DIRECTION.RIGHT_UP);
  }
  if (0 === matrix[DOG_LOCATION.LINE + 1][DOG_LOCATION.LIST + 1]) {
    canMove.push(DIRECTION.RIGHT_DOWN);
  }
                                          
    if (0 === canMove.length) {
      // Win
     alert("You Win!");
    } else {
      // Move.
      var random =  parseInt(Math.random() * canMove.length);
      var moved = canMove[random];
      console.error(moved);
      switch(moved){
        case DIRECTION.LEFT:
              DOG_LOCATION.LIST--;
              break;
        case DIRECTION.RIGHT:
              DOG_LOCATION.LIST++;
              break;
        case DIRECTION.UP:
              DOG_LOCATION.LINE--;
              break;
        case DIRECTION.DOWN:
              DOG_LOCATION.LINE++;
              break;
        case DIRECTION.LEFT_UP:
              DOG_LOCATION.LINE--;
              DOG_LOCATION.LIST--;
              break;
        case DIRECTION.LEFT_DOWN:
              DOG_LOCATION.LINE++;
              DOG_LOCATION.LIST--;
              break;
        case DIRECTION.RIGHT_UP:
              DOG_LOCATION.LINE--;
              DOG_LOCATION.LIST++;
              break;
        case DIRECTION.RIGHT_DOWN:
              DOG_LOCATION.LINE++;
              DOG_LOCATION.LIST++;
              break;
        default:
          break;
      }
      
      //
      setDogLocation(DOG_LOCATION.LINE, DOG_LOCATION.LIST);
    }
   
  // Clear.
  canMove = [];
}

// Create the matrix.
function createGameMatrix(){

   matrix = new Array();
  
   for(var row = 0; row < totalLine; row++) {
       matrix[row] = new Array();
       for(var col = 0; col < totalList; col++)   {
         matrix[row][col] = 0;
       } 
   }
}
</script>
  
</body>
</html>
